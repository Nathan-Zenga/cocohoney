<%- include ('partials/header') -%>
    <div class="form-container">
        <ul class="nav nav-pills">
            <li>
                <a data-toggle="none" href="/admin">
                    <i class="fal fa-chevron-left" style="font-size: 1.2em; margin-right: 10px"></i> BACK
                </a>
            </li>
        </ul>
        <form method="post" id="mail-form" action="/admin/mail/send">
            <fieldset>
                <legend>NEW EMAIL</legend>

                <label>EMAIL <i class="dropdown-arrow fal fa-chevron-down"></i></label>
                <select name="email" id="email" required>
                    <option value="">-</option>
                    <%_ members.forEach((member, i) => { _%>
                    <option value="<%= member.email %>"><%= member.firstname+" "+member.lastname %></option>
                    <%_ }) _%>
                </select>

                <label>SUBJECT</label>
                <input type="text" name="subject" id="subject" required>

                <label>MESSAGE</label>
                <textarea name="message" id="message" rows="10" required></textarea>

                <input type="submit" value="SEND">
            </fieldset>
        </form>

        <div class="form-container" style="max-width: 600px; margin: 0 auto; padding: 1em 0 0">
            <div class="row">
                <div class="col-sm-6">
                    <form class="minimal" action="/admin/mail/send/all">
                        <button type="submit">SEND TO EVERYONE</button>
                    </form>
                </div>
                <div class="col-sm-6">
                    <form class="minimal" action="/admin/mail/send/ambassador">
                        <button type="submit">SEND TO AMBASSADORS</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script>
        $("form").submit(function(e) {
            e.preventDefault();
            var btnController = new submitBtnController(this);
            $.post(this.action, $("#mail-form").serializeArray(), function(result) {
                alert(result);
                e.target.reset();
            }).fail(function(err) {
                alert(err.responseText);
            }).always(function() {
                btnController.finish();
            });
        });
    </script>
<%- include ('partials/footer') -%>